<!DOCTYPE html>
<html>
	<head>
		<!--Code written by Shangzhen Yang-->
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
		<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,viewport-fit=cover">
		<meta name="theme-color" content="#0066cc">
		<meta name="renderer" content="webkit">
		<link href="css/mui.min.css" rel="stylesheet">
		<link href="css/general.css" rel="stylesheet">
	</head>
	<body>
		<header class="mui-bar mui-bar-nav title"></header>
		<div class="mui-content">
			<table style="width:100%;display:none">
				<tbody>
					<tr>
						<td width="30%">
							<select>
								<option value="AUD">AUD</option>
								<option value="CAD">CAD</option>
								<option value="CNY">CNY</option>
								<option value="EUR">EUR</option>
								<option value="GBP">GBP</option>
								<option value="HKD">HKD</option>
								<option value="JPY">JPY</option>
								<option value="KRW">KRW</option>
								<option value="MOP">MOP</option>
								<option value="MXN">MXN</option>
								<option value="SGD">SGD</option>
								<option value="TWD">TWD</option>
								<option value="USD">USD</option>
							</select>
						</td>
						<td width="70%">
							<input type="text">
						</td>
					</tr>
					<tr>
						<td width="30%">
							<select>
								<option value="AUD">AUD</option>
								<option value="CAD">CAD</option>
								<option value="CNY">CNY</option>
								<option value="EUR">EUR</option>
								<option value="GBP">GBP</option>
								<option value="HKD">HKD</option>
								<option value="JPY">JPY</option>
								<option value="KRW">KRW</option>
								<option value="MOP">MOP</option>
								<option value="MXN">MXN</option>
								<option value="SGD">SGD</option>
								<option value="TWD">TWD</option>
								<option value="USD">USD</option>
							</select>
						</td>
						<td width="70%">
							<input type="text">
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<footer>
			<div id="UpdateRate" style="width:100%"></div>
		</footer>
		<script src="js/check.js"></script>
		<!--[if !IE]><!-->
		<script src="js/mui.min.js"></script>
		<script src="js/general.js"></script>
		<script type="text/javascript">
			let rate=localStorage.getItem("Rate")
			function calculate1(){
				if(document.getElementsByTagName("input")[0].value!=""){
					if(document.getElementsByTagName("select")[0].value=="USD"){
						document.getElementsByTagName("input")[1].value=document.getElementsByTagName("input")[0].value*eval("const rate="+rate+";rate.quotes.USD"+document.getElementsByTagName("select")[1].value)
					}else{
						document.getElementsByTagName("input")[1].value=eval("const rate="+rate+";"+document.getElementsByTagName("input")[0].value+"/rate.quotes.USD"+document.getElementsByTagName("select")[0].value+"*rate.quotes.USD"+document.getElementsByTagName("select")[1].value)
					}
				}else{
					document.getElementsByTagName("input")[1].value=""
				}
			}
			function calculate2(){
				if(document.getElementsByTagName("input")[1].value!=""){
					if(document.getElementsByTagName("select")[1].value=="USD"){
						document.getElementsByTagName("input")[0].value=document.getElementsByTagName("input")[1].value*eval("const rate="+rate+";rate.quotes.USD"+document.getElementsByTagName("select")[0].value)
					}else{
						document.getElementsByTagName("input")[0].value=eval("const rate="+rate+";"+document.getElementsByTagName("input")[1].value+"/rate.quotes.USD"+document.getElementsByTagName("select")[1].value+"*rate.quotes.USD"+document.getElementsByTagName("select")[0].value)
					}
				}else{
					document.getElementsByTagName("input")[0].value=""
				}
			}
			function updateRate(){
				request("http://www.apilayer.net/api/live?access_key=305f5a80f4da12a238c9ebfe5479c648",function(e){
					const json=JSON.parse(e)
					if(json.success){
						rate=e
						localStorage.setItem("Rate",rate)
						document.getElementsByTagName("table")[0].style.display=""
					}
				})
			}
			document.getElementsByTagName("select")[0].onchange=calculate2
			document.getElementsByTagName("input")[0].oninput=calculate1
			document.getElementsByTagName("select")[1].onchange=calculate1
			document.getElementsByTagName("input")[1].oninput=calculate2
			document.getElementById("UpdateRate").onclick=updateRate
			switch(language){
				case "SimplifiedChinese":
					document.title="计算器"
					document.getElementById("UpdateRate").innerText="更新汇率"
					break
				default:
					document.title="Calculator"
					document.getElementById("UpdateRate").innerText="Update the exchange rate"
					break
			}
			document.getElementsByClassName("mui-title")[0].innerText=document.title
			document.getElementsByTagName("select")[0].value="CNY"
			document.getElementsByTagName("select")[1].value="USD"
			if(rate){
				document.getElementsByTagName("table")[0].style.display=""
			}else{
				updateRate()
			}
		</script>
		<!--<![endif]-->
	</body>
</html>
