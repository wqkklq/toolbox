<!DOCTYPE html>
<html>
	<head>
		<!-- Code written by Shangzhen Yang -->
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, viewport-fit=cover" />
		<meta name="theme-color" content="#0066cc" />
		<title>RTH Toolbox</title>
		<link href="unpackage/res/icons/512x512.png" rel="apple-touch-icon" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<link href="css/general.css" rel="stylesheet" />
	</head>
	<body>
		<header class="mui-bar mui-bar-nav title">
			<a class="mui-action-back mui-icon mui-icon-blue mui-icon-left-nav mui-pull-left back"></a>
		   	<h1 id="ToolboxTitle" class="mui-title"></h1>
		</header>
		<div class="mui-content">
			<div class="mui-input-row">
			    <input id="Time" type="text" value="00:00:00" style="text-align: center;" oninput="TimeInput();" onkeydown="if(event.keyCode==13){document.getElementById('StartButton').click();}" />
			</div>
			<div class="mui-input-row mui-input-range">
			    <label id="HourLabel"></label>
                <input type="range" id="Hour" value="0" min="0" max="23" onchange="TimeChanged();" />
			</div>
			<div class="mui-input-row mui-input-range">
			    <label id="MinuteLabel"></label>
			    <input type="range" id="Minute" value="0" min="0" max="59" onchange="TimeChanged();" />
			</div>
			<div class="mui-input-row mui-input-range">
			    <label id="SecondLabel"></label>
			    <input type="range" id="Second" value="0" min="0" max="59" onchange="TimeChanged();" />
			</div>
			<select id="Mode" style="margin-top: 15px;"></select>
			<button id="StartButton" type="button" class="mui-btn mui-btn-blue mui-btn-block"></button>
			<button id="PauseButton" type="button" class="mui-btn mui-btn-block" disabled="disabled" onclick="Pause();"></button>
			<fieldset style="margin-top: 20px;">
				<legend id="TimedTask"></legend>
				<div class="mui-input-row mui-checkbox">
					<label id="CreateMessageBoxLabel"></label>
					<input id="CreateMessageBoxCheck" name="Checkbox" type="checkbox" checked="checked" />
				</div>
				<div class="mui-input-row">
					<input id="CreateMessageBoxInput" type="text" class="mui-input-clear" />
				</div>
				<div class="mui-input-row mui-checkbox">
					<label id="OpenWebPageLabel"></label>
					<input id="OpenWebPageCheck" name="Checkbox" type="checkbox" />
				</div>
				<div class="mui-input-row">
					<input id="OpenWebPageInput" type="text" class="mui-input-clear" />
				</div>
				<div id="SpeakDiv1" class="mui-input-row mui-checkbox">
					<label id="SpeakLabel"></label>
					<input id="SpeakCheck" name="Checkbox" type="checkbox" checked="checked" />
				</div>
				<div id="SpeakDiv2" class="mui-input-row">
					<input id="SpeakInput" type="text" class="mui-input-clear" />
				</div>
				<div id="PushNotificationDiv1" class="mui-input-row mui-checkbox">
					<label id="PushNotificationLabel"></label>
					<input id="PushNotificationCheck" name="Checkbox" type="checkbox" checked="checked" />
				</div>
				<div id="PushNotificationDiv2" class="mui-input-row">
					<input id="PushNotificationInput" type="text" class="mui-input-clear" />
				</div>
				<button id="PreviewButton" type="button" class="mui-btn mui-btn-block" onclick="Task();"></button>
			</fieldset>
			<fieldset style="margin-top: 20px;">
				<legend id="History"></legend>
				<textarea id="HistoryText" rows="5"></textarea>
				<ul class="mui-table-view">
			        <li class="mui-table-view-cell">
			            <a id="Add" href="javascript:Add();" class="mui-navigate-right"></a>
			        </li>
			        <li class="mui-table-view-cell">
			            <a id="Clear" href="javascript:document.getElementById('HistoryText').value='';" class="mui-navigate-right"></a>
			        </li>
			    </ul>
			</fieldset>
		</div>
		<script type="text/javascript">
			var Language=localStorage.getItem("Language"),Hour,Minute,Second,TimeOut;
			if(Language=="SimplifiedChinese"){
				document.getElementById("ToolboxTitle").innerText="计时器";
				document.getElementById("HourLabel").innerText="时";
				document.getElementById("MinuteLabel").innerText="分";
				document.getElementById("SecondLabel").innerText="秒";
				document.getElementById("Mode").options.add(new Option("倒计时","Countdown"));
				document.getElementById("Mode").options.add(new Option("秒表","Stopwatch"));
				document.getElementById("StartButton").innerText="开始";
				document.getElementById("PauseButton").innerText="暂停";
				document.getElementById("TimedTask").innerText="定时任务";
				document.getElementById("CreateMessageBoxLabel").innerText="创建消息框";
				document.getElementById("CreateMessageBoxInput").placeholder="输入消息框的内容";
				document.getElementById("CreateMessageBoxInput").value="时间到！";
				document.getElementById("OpenWebPageLabel").innerText="打开网页";
				document.getElementById("OpenWebPageInput").placeholder="输入网址";
				document.getElementById("SpeakLabel").innerText="朗读";
				document.getElementById("SpeakInput").placeholder="输入朗读的文本";
				document.getElementById("SpeakInput").value="时间到！";
				document.getElementById("PushNotificationLabel").innerText="推送通知";
				document.getElementById("PushNotificationInput").placeholder="输入通知的内容";
				document.getElementById("PushNotificationInput").value="时间到！";
				document.getElementById("PreviewButton").innerText="预览";
				document.getElementById("History").innerText="历史记录";
				document.getElementById("HistoryText").placeholder="还没有历史记录";
				document.getElementById("Add").innerText="添加";
				document.getElementById("Clear").innerText="清空";
			}else{
				document.getElementById("ToolboxTitle").innerText="Timer";
				document.getElementById("HourLabel").innerText="Hour";
				document.getElementById("MinuteLabel").innerText="Minute";
				document.getElementById("SecondLabel").innerText="Second";
				document.getElementById("Mode").options.add(new Option("Countdown","Countdown"));
				document.getElementById("Mode").options.add(new Option("Stopwatch","Stopwatch"));
				document.getElementById("StartButton").innerText="Start";
				document.getElementById("PauseButton").innerText="Pause";
				document.getElementById("TimedTask").innerText="Timed Task";
				document.getElementById("CreateMessageBoxLabel").innerText="Create Message Box";
				document.getElementById("CreateMessageBoxInput").placeholder="Enter the contents";
				document.getElementById("CreateMessageBoxInput").value="Time out!";
				document.getElementById("OpenWebPageLabel").innerText="Open Web Page";
				document.getElementById("OpenWebPageInput").placeholder="Enter the URL";
				document.getElementById("SpeakLabel").innerText="Speak";
				document.getElementById("SpeakInput").placeholder="Enter the text";
				document.getElementById("SpeakInput").value="Time out!";
				document.getElementById("PushNotificationLabel").innerText="Push Notification";
				document.getElementById("PushNotificationInput").placeholder="Enter the contents";
				document.getElementById("PushNotificationInput").value="Time out!";
				document.getElementById("PreviewButton").innerText="Preview";
				document.getElementById("History").innerText="History";
				document.getElementById("HistoryText").placeholder="The history is empty";
				document.getElementById("Add").innerText="Add";
				document.getElementById("Clear").innerText="Clear";
			}
			if(!window.speechSynthesis){
				document.getElementById("SpeakDiv1").style.display="none";
				document.getElementById("SpeakDiv2").style.display="none";
			}
			WidthChanged();
			function WidthChanged(){
				if(document.documentElement.clientWidth>500){
					document.getElementById("Time").style.fontSize="45px";
					document.getElementById("Time").style.height="90px";
				}else{
					document.getElementById("Time").style.fontSize="";
					document.getElementById("Time").style.height="";
				}
			}
		</script>
		<script src="js/mui.min.js"></script>
		<script type="text/javascript">
			if(navigator.userAgent.indexOf("Html5Plus")!=-1&&navigator.userAgent.indexOf("Android")!=-1){mui.init({swipeBack:true});}
			else{mui.init({swipeBack:false});}
			window.onresize=WidthChanged;
			if(window.location.href.indexOf("rths.tk")!=-1){document.write("<script async src='\/\/pagead2.googlesyndication.com/pagead/js/adsbygoogle.js'><\/script><ins class='adsbygoogle' style='display:block' data-ad-client='ca-pub-3063060312105983' data-ad-slot='4806317432' data-ad-format='auto'><\/ins><script>(adsbygoogle = window.adsbygoogle || []).push({});<\/script><script async src='https://www.googletagmanager.com/gtag/js?id=UA-109975281-1'><\/script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-109975281-1');<\/script>");}
			if(navigator.userAgent.indexOf("Electron")!=-1){require("electron").webFrame.setZoomLevelLimits(1,1);}
			if(navigator.userAgent.indexOf("Html5Plus")==-1){
				if(window.Notification){
					Notification.requestPermission(function (){
						if(Notification.permission!="granted"){
							document.getElementById("PushNotificationDiv1").style.display="none";
							document.getElementById("PushNotificationDiv2").style.display="none";
						}
					});
				}else{
					document.getElementById("PushNotificationDiv1").style.display="none";
					document.getElementById("PushNotificationDiv2").style.display="none";
				}
			}
			function TimeInput(){
				var TimeSplit=document.getElementById("Time").value.split(":");
				if(TimeSplit.length<3){
					document.getElementById("Second").value=0;
					document.getElementById("Minute").value=0;
					document.getElementById("Hour").value=0;
				}else{
					document.getElementById("Second").value=TimeSplit[2];
					document.getElementById("Minute").value=TimeSplit[1];
					document.getElementById("Hour").value=TimeSplit[0];
				}
			}
			function AddZero(num,length){return (Array(length).join("0")+num).slice(-length);}
			function TimeChanged(){
				var SecondStr=AddZero(document.getElementById("Second").value,2),
				MinuteStr=AddZero(document.getElementById("Minute").value,2),
				HourStr=AddZero(document.getElementById("Hour").value,2);
				if(SecondStr=="0"){SecondStr="00";}
				if(MinuteStr=="0"){MinuteStr="00";}
				if(HourStr=="0"){HourStr="00";}
				document.getElementById("Time").value=HourStr+":"+MinuteStr+":"+SecondStr;
			}
			document.getElementById("StartButton").onclick=function(){
				Second=parseInt(document.getElementById("Second").value);
				Minute=parseInt(document.getElementById("Minute").value);
				Hour=parseInt(document.getElementById("Hour").value);
				if(document.getElementById("Mode").value=="Countdown"){
					if(Hour==0 && Minute==0 && Second==0){
						if(Language=="SimplifiedChinese"){mui.alert("请设置倒计时时间","计时器");}
						else{mui.alert("Please set the countdown time","Timer","OK");}
					}else{
						document.getElementById("Mode").disabled="disabled";
						document.getElementById("StartButton").disabled="disabled";
						document.getElementById("PauseButton").disabled="";
						Countdown();
					}
				}else if(document.getElementById("Mode").value=="Stopwatch"){
					document.getElementById("Mode").disabled="disabled";
					document.getElementById("StartButton").disabled="disabled";
					document.getElementById("PauseButton").disabled="";
					Stopwatch();
				}
			}
			function Task(){
				if(document.getElementById("CreateMessageBoxCheck").checked==true){
					if(Language=="SimplifiedChinese"){mui.alert(document.getElementById("CreateMessageBoxInput").value,"计时器");}
					else{mui.alert(document.getElementById("CreateMessageBoxInput").value,"Timer","OK");}
				}
				if(document.getElementById("OpenWebPageCheck").checked==true){
					if(navigator.userAgent.indexOf("Html5Plus")!=-1){plus.runtime.openURL(document.getElementById("OpenWebPageInput").value);}
					else if(navigator.userAgent.indexOf("Electron")!=-1){require("electron").shell.openExternal(document.getElementById("OpenWebPageInput").value);}
					else{window.open(document.getElementById("OpenWebPageInput").value);}
				}
				if(document.getElementById("SpeakCheck").checked==true&&window.speechSynthesis){window.speechSynthesis.speak(new SpeechSynthesisUtterance(document.getElementById("SpeakInput").value));}
				if(document.getElementById("PushNotificationCheck").checked==true){
					if(navigator.userAgent.indexOf("Html5Plus")!=-1){plus.push.createMessage(document.getElementById("PushNotificationInput").value);}
					else if(window.Notification){
						if(Notification.permission=="granted"){
							var notification=new Notification(document.getElementById("ToolboxTitle").innerText,{
								body:document.getElementById("PushNotificationInput").value,
								icon:"unpackage/res/icons/512x512.png"
							});
							notification.onclick=function(){notification.close();}
						}
					}
				}
			}
			function Countdown(){
				if(Hour==0&&Minute==0&&Second==0){
					Pause();
					Task();
					return false;
				}else if(Second==0){
					Second=59;
					document.getElementById("Second").value=Second;
					if(Minute==0){
						Minute=59;
						document.getElementById("Minute").value=Minute;
						Hour=Hour-1;
						document.getElementById("Hour").value=Hour;
					}else{
						Minute=Minute-1;
						document.getElementById("Minute").value=Minute;
					}
				}else{
					Second=Second-1;
					document.getElementById("Second").value=Second;
				}
				TimeChanged();
				TimeOut=setTimeout("Countdown()",1000);
			}
			function Stopwatch(){
				if(Second==59){
					Second=0;
					document.getElementById("Second").value=Second;
					if(Minute==59){
						Minute=0;
						document.getElementById("Minute").value=Minute;
						Hour=Hour+1;
						document.getElementById("Hour").value=Hour;
					}else{
						Minute=Minute+1;
						document.getElementById("Minute").value=Minute;
					}
				}else{
					Second=Second+1;
					document.getElementById("Second").value=Second;
				}
				TimeChanged();
				TimeOut=setTimeout("Stopwatch()",1000);
			}
			function Pause(){
				clearTimeout(TimeOut);
				document.getElementById("Mode").disabled="";
				document.getElementById("StartButton").disabled="";
				document.getElementById("PauseButton").disabled="disabled";
			}
			function Add(){
				var DateValue=new Date();
				var TimeStr=document.getElementById("Time").value+" ("+DateValue.getHours()+":"+DateValue.getMinutes()+":"+DateValue.getSeconds()+")",
				HistoryValue=document.getElementById("HistoryText").value;
				if(HistoryValue==""){document.getElementById("HistoryText").value=TimeStr;}
				else{document.getElementById("HistoryText").value=TimeStr+"\n"+HistoryValue;}
			}
		</script>
	</body>
</html>