<!DOCTYPE html>
<html>
	<head>
		<!--Code written by Shangzhen Yang-->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,viewport-fit=cover">
		<meta name="theme-color" content="#0066cc">
		<title>RTH Toolbox</title>
		<link href="unpackage/res/icons/512x512.png" rel="apple-touch-icon">
		<link href="css/mui.min.css" rel="stylesheet">
		<link href="css/general.css" rel="stylesheet">
	</head>
	<body>
		<header class="mui-bar mui-bar-nav title">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left back"></a>
			<h1 class="mui-title"></h1>
		</header>
		<div class="win" style="display:none">
			<div style="right:80px" onclick="require('electron').remote.getCurrentWindow().minimize()">-</div>
			<div style="right:40px" onclick="Maximize()">+</div>
			<div style="right:0px" onclick="window.close()">×</div>
		</div>
		<div class="mui-content">
			<select id="LanguageSelect" onchange="LanguageChanged()">
				<option value="SimplifiedChinese">简体中文</option>
				<option value="English">English</option>
			</select>
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a id="About" class="mui-navigate-right" href="javascript:OpenWindow('about')"></a>
				</li>
				<li class="mui-table-view-cell">
					<a id="ClearData" class="mui-navigate-right" href="javascript:ClearData()"></a>
				</li>
			</ul>
		</div>
		<script type="text/javascript">
			document.getElementById("LanguageSelect").value=localStorage.getItem("Language")
			LanguageChanged()
			function LanguageChanged(){
				if(document.getElementById("LanguageSelect").value=="SimplifiedChinese"){
					document.title="设置"
					document.getElementById("About").innerText="关于 RTH 工具箱"
					document.getElementById("ClearData").innerText="清除数据"
				}else{
					document.title="Settings"
					document.getElementById("About").innerText="About RTH Toolbox"
					document.getElementById("ClearData").innerText="Clear Data"
				}
				document.getElementsByClassName("mui-title")[0].innerText=document.title
				if(window.localStorage&&document.getElementById("LanguageSelect").value!=localStorage.getItem("Language")){
					localStorage.setItem("Language",document.getElementById("LanguageSelect").value)
					if(document.getElementById("LanguageSelect").value=="SimplifiedChinese"){mui.alert("需要重新启动 RTH 工具箱","已应用",function(e){Restart()})}
					else{mui.alert("RTH Toolbox needs to be restarted","Applied","OK",function(e){Restart()})}
				}
			}
		</script>
		<script src="js/mui.min.js"></script>
		<script src="js/general.js"></script>
		<script type="text/javascript">
			Init(true)
			function Restart(){
				if(navigator.userAgent.indexOf("Html5Plus")!=-1){plus.runtime.restart()}
				else if(navigator.userAgent.indexOf("Electron")!=-1){
					require("electron").ipcRenderer.send("restart-index")
					window.close()
				}else{window.location.href="index.html"}
			}
			function ClearData(){
				if(navigator.userAgent.indexOf("Html5Plus")!=-1){
					plus.cache.clear()
					plus.navigator.removeAllCookie()
				}
				if(window.localStorage){
					if(document.getElementById("LanguageSelect").value=="SimplifiedChinese"){mui.confirm("您想要清除应用数据吗？","清除",["否","是"],function(e){if(e.index==1){ClearDataTrue()}})}
					else{mui.confirm("Do you want to clear the app data?","Clear",["No","Yes"],function(e){if(e.index==1){ClearDataTrue()}})}
					function ClearDataTrue(){
						localStorage.clear()
						var Num=10000+Math.round(Math.random()*89999)
						if(document.getElementById("LanguageSelect").value=="SimplifiedChinese"){mui.alert("需要重新启动 RTH 工具箱 ["+Num+"]","已清除",function(e){Restart()})}
						else{mui.alert("RTH Toolbox needs to be restarted ["+Num+"]","Cleared","OK",function(e){Restart()})}
					}
				}
			}
		</script>
	</body>
</html>