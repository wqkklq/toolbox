<!DOCTYPE html>
<html>
	<head>
		<!--Code written by Shangzhen Yang-->
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
		<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,viewport-fit=cover">
		<meta name="theme-color" content="#0066cc">
		<meta name="renderer" content="webkit">
		<title>RTH Toolbox</title>
		<link href="unpackage/res/icons/512x512.png" rel="apple-touch-icon">
		<link href="css/mui.min.css" rel="stylesheet">
		<link href="css/general.css" rel="stylesheet">
		<style>
			.number{
				font-size:45px;
				text-align:center;
				line-height:60px;
				height:60px;
				-webkit-user-select:text;
				user-select:text
			}
		</style>
	</head>
	<body>
		<header class="mui-bar mui-bar-nav title">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left back"></a>
			<h1 class="mui-title"></h1>
		</header>
		<div class="win" style="display:none">
			<div style="right:80px" onclick="require('electron').remote.getCurrentWindow().minimize()">-</div>
			<div style="right:40px" onclick="maximize()">+</div>
			<div style="right:0px" onclick="window.close()">×</div>
		</div>
		<div class="mui-content">
			<div class="number">0</div>
			<button type="button" class="mui-btn mui-btn-blue mui-btn-block" style="margin-top:20px"></button>
			<fieldset style="margin-top:20px">
				<legend id="Settings"></legend>
				<div class="mui-input-row">
					<label id="MinimumLabel"></label>
					<input id="Minimum" type="text" value="1">
				</div>
				<div class="mui-input-row">
					<label id="MaximumLabel"></label>
					<input id="Maximum" type="text" value="60">
				</div>
				<div class="mui-input-row mui-checkbox ">
					<label id="ScrollLabel"></label>
					<input id="ScrollCheck" name="Checkbox" type="checkbox" checked="checked" onchange="scrollChanged()">
				</div>
				<div class="mui-input-row mui-checkbox ">
					<label id="OddNumberOnlyLabel"></label>
					<input id="OddNumberOnlyCheck" name="Checkbox" type="checkbox" onchange="document.getElementById('EvenNumberOnlyCheck').checked=false">
				</div>
				<div class="mui-input-row mui-checkbox ">
					<label id="EvenNumberOnlyLabel"></label>
					<input id="EvenNumberOnlyCheck" name="Checkbox" type="checkbox" onchange="document.getElementById('OddNumberOnlyCheck').checked=false">
				</div>
			</fieldset>
			<fieldset style="margin-top:20px">
				<legend id="History"></legend>
				<textarea id="HistoryText" rows="5"></textarea>
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<a id="Add" href="javascript:add()" class="mui-navigate-right"></a>
					</li>
					<li class="mui-table-view-cell">
						<a id="Clear" href="javascript:document.getElementById('HistoryText').value=''" class="mui-navigate-right"></a>
					</li>
				</ul>
			</fieldset>
			<fieldset style="margin-top:20px">
				<legend id="Names"></legend>
				<textarea id="NamesText" rows="5"></textarea>
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<a id="NamesSave" href="javascript:namesSave()" class="mui-navigate-right"></a>
					</li>
					<li class="mui-table-view-cell">
						<a id="NamesAdd" href="javascript:namesAdd()" class="mui-navigate-right"></a>
					</li>
					<li class="mui-table-view-cell">
						<a id="NamesClear" href="javascript:namesClear()" class="mui-navigate-right"></a>
					</li>
				</ul>
			</fieldset>
		</div>
		<!--[if IE]>
			<script type="text/javascript">
				window.location.href="http://t.rths.tk/web/toolbox/download.html?time="+(new Date).getTime()
			</script>
		<![endif]-->
		<!--[if !IE]><!-->
		<script src="js/mui.min.js"></script>
		<script src="js/general.js"></script>
		<script type="text/javascript">
			var namesValue=localStorage.getItem("Names"),scrolling=true,multipleTimes=true,intervalId
			if(language=="SimplifiedChinese"){
				document.title="随机抽号"
				document.getElementsByTagName("button")[0].innerText="立即抽号"
				document.getElementById("Settings").innerText="设置"
				document.getElementById("MinimumLabel").innerText="最小值"
				document.getElementById("MaximumLabel").innerText="最大值"
				document.getElementById("ScrollLabel").innerText="滚动"
				document.getElementById("OddNumberOnlyLabel").innerText="仅奇数"
				document.getElementById("EvenNumberOnlyLabel").innerText="仅偶数"
				document.getElementById("History").innerText="历史记录"
				document.getElementById("HistoryText").placeholder="还没有历史记录"
				document.getElementById("Add").innerText="添加"
				document.getElementById("Clear").innerText="清空"
				document.getElementById("Names").innerText="名字"
				document.getElementById("NamesText").placeholder="输入每个人的名字"
				document.getElementById("NamesSave").innerText="保存"
				document.getElementById("NamesAdd").innerText="添加"
				document.getElementById("NamesClear").innerText="清空"
			}else{
				document.title="Random Number"
				document.getElementsByTagName("button")[0].innerText="Select Randomly"
				document.getElementById("Settings").innerText="Settings"
				document.getElementById("MinimumLabel").innerText="Minimum"
				document.getElementById("MaximumLabel").innerText="Maximum"
				document.getElementById("ScrollLabel").innerText="Scroll"
				document.getElementById("OddNumberOnlyLabel").innerText="Odd Number Only"
				document.getElementById("EvenNumberOnlyLabel").innerText="Even Number Only"
				document.getElementById("History").innerText="History"
				document.getElementById("HistoryText").placeholder="The history is empty"
				document.getElementById("Add").innerText="Add"
				document.getElementById("Clear").innerText="Clear"
				document.getElementById("Names").innerText="Names"
				document.getElementById("NamesText").placeholder="Enter everyone's name"
				document.getElementById("NamesSave").innerText="Save"
				document.getElementById("NamesAdd").innerText="Add"
				document.getElementById("NamesClear").innerText="Clear"
			}
			document.getElementsByClassName("mui-title")[0].innerText=document.title
			document.getElementById("NamesText").value=namesValue
			count()
			intervalId=setInterval(function(){RScrolling()},10)
			function count(){
				if(namesValue==""||namesValue==null){
					document.getElementById("Minimum").value="1"
					document.getElementById("Maximum").value="60"
				}else{
					document.getElementById("Minimum").value="0"
					document.getElementById("Maximum").value=namesValue.split("\n").length-2
				}
			}
			function random(){
				var min=parseInt(document.getElementById("Minimum").value),
				max=parseInt(document.getElementById("Maximum").value)
				var RandomNumberValue=min+Math.round(Math.random()*(max-min))
				if(document.getElementById("OddNumberOnlyCheck").checked==true&&RandomNumberValue%2==0||document.getElementById("EvenNumberOnlyCheck").checked==true&&RandomNumberValue%2!=0){
					random()
					return false
				}
				if(namesValue!=""&&namesValue!=null){
					var namesSplit
					namesSplit=namesValue.split("\n")
					document.getElementsByClassName("number")[0].innerText=namesSplit[RandomNumberValue]
				}else{document.getElementsByClassName("number")[0].innerText=RandomNumberValue}
			}
			function RScrolling(){
				var min=parseInt(document.getElementById("Minimum").value),
				max=parseInt(document.getElementById("Maximum").value)
				if(min==max){document.getElementsByClassName("number")[0].innerText="?"}
				else{random()}
				scrolling=true
			}
			document.getElementsByTagName("button")[0].onclick=function(){
				var selected=function(){
					if(multipleTimes==false){
						namesValue=namesValue.replace(document.getElementsByClassName("number")[0].innerText+"\n","")
						count()
					}
				}
				if(document.getElementById("ScrollCheck").checked==true){
					if(scrolling==false){
						intervalId=setInterval(function(){RScrolling()},10)
						scrolling=true
					}else{
						clearInterval(intervalId)
						scrolling=false
						if(document.getElementsByClassName("number")[0].innerText=="?"){random()}
						selected()
					}
				}else{
					random()
					selected()
				}
			}
			function scrollChanged(){
				if(document.getElementById("ScrollCheck").checked==true){
					intervalId=setInterval(function(){RScrolling()},10)
					scrolling=true
				}else{
					clearInterval(intervalId)
					scrolling=false
				}
			}
			function add(){
				var historyValue=document.getElementById("HistoryText").value
				if(historyValue==""){document.getElementById("HistoryText").value=document.getElementsByClassName("number")[0].innerText}
				else{document.getElementById("HistoryText").value=document.getElementsByClassName("number")[0].innerText+"\n"+historyValue}
			}
			function namesSave(){
				multipleTimes=true
				document.getElementById("NamesText").style.display=""
				namesValue=document.getElementById("NamesText").value
				var namesSplit=namesValue.split("\n")
				if(namesSplit[namesSplit.length-1]!=""){namesValue+="\n"}
				localStorage.setItem("Names",namesValue)
				count()
				window.scrollTo(0,0)
				var noMultipleTimes=function(){
					multipleTimes=false
					document.getElementById("NamesText").style.display="none"
				}
				if(language=="SimplifiedChinese"){mui.confirm("一个名字能被抽到多次吗？","随机抽号",["否","是"],function(e){if(e.index==0){noMultipleTimes()}})}
				else{mui.confirm("Can a name be selected multiple times?","Random Number",["No","Yes"],function(e){if(e.index==0){noMultipleTimes()}})}
			}
			function namesAdd(){
				multipleTimes=true
				document.getElementById("NamesText").style.display=""
				var addTrue=function(e){
					var namesSplit=document.getElementById("NamesText").value.split("\n")
					if(namesSplit[namesSplit.length-1]!=""){document.getElementById("NamesText").value+="\n"}
					document.getElementById("NamesText").value+=e.value
				}
				if(language=="SimplifiedChinese"){mui.prompt("输入一个人的名字","","添加",function(e){if(e.index==1){addTrue(e)}})}
				else{mui.prompt("Enter a person's name","","Add",["Cancel","OK"],function(e){if(e.index==1){addTrue(e)}})}
			}
			function namesClear(){
				document.getElementById("NamesText").value=""
				localStorage.removeItem("Names")
				namesValue=""
				multipleTimes=true
				document.getElementById("NamesText").style.display=""
				count()
			}
		</script>
		<!--<![endif]-->
	</body>
</html>